// Generated by CoffeeScript 1.6.3
(function() {
  define(['jQuery', 'angular', 'bootstrap'], function($, angular) {
    var Modals;
    Modals = (function() {
      var _tpl;

      _tpl = '\
            <div class="modal fade" role="dialog" aria-hidden="true">\
              <div class="modal-dialog">\
                <div class="modal-content">\
                  <div class="modal-header">\
                    <button type="button" data-dismiss="modal" aria-hidden="true" class="close">&times;</button>\
                    <h4 class="modal-title"></h4>\
                  </div>\
                  <div class="modal-body"></div>\
                  <div class="modal-footer"></div>\
                </div><!-- /.modal-content -->\
              </div><!-- /.modal-dialog -->\
            </div><!-- /.modal -->\
        ';

      function Modals(body, title, footer) {
        this.body = body != null ? body : '';
        this.title = title != null ? title : '';
        this.footer = footer != null ? footer : '';
        this.el = $(_tpl);
      }

      Modals.prototype.setDom = function(selectName, target) {
        var selectEl;
        selectEl = this.el.find(selectName);
        if (angular.isString(target)) {
          selectEl.html(target);
        } else if (angular.isFunction(target.appendTo)) {
          target.appendTo(selectEl);
        }
        return selectEl;
      };

      Modals.prototype.setTitle = function(title) {
        return this.setDom('.modal-title', title);
      };

      Modals.prototype.setBody = function(body) {
        return this.setDom('.modal-body', body);
      };

      Modals.prototype.setFooter = function(footer) {
        return this.setDom('.modal-footer', footer);
      };

      Modals.prototype.alert = function(body, callback) {
        var _this = this;
        this.body = body;
        if (callback == null) {
          callback = function() {};
        }
        this.el = $(_tpl);
        this.footer = $('<button type="button" data-dismiss="modal" class="btn btn-primary">确定</button>');
        this.setTitle('提示信息');
        this.setBody(this.body);
        this.setFooter(this.footer);
        this.el.modal({
          backdrop: false
        });
        this.el.on('hidden.bs.modal', function() {
          _this.el.remove();
          callback();
        });
        return this.el;
      };

      Modals.prototype.confirm = function(body, callback) {
        var ret,
          _this = this;
        this.body = body;
        if (callback == null) {
          callback = function() {};
        }
        this.el = $(_tpl);
        this.footer = $('\
                <button type="button" data-dismiss="modal" class="btn btn-default">取消</button>\
\
                <button type="button" role="yes" data-dismiss="modal" class="btn btn-primary">确定</button>\
            ');
        this.setTitle('提示信息');
        this.setBody(this.body);
        this.setFooter(this.footer);
        ret = false;
        this.el.on('click', '[role=yes]', function() {
          return ret = true;
        });
        this.el.modal({
          backdrop: false
        });
        this.el.on('hidden.bs.modal', function() {
          _this.el.remove();
          callback(ret);
        });
        return this.el;
      };

      return Modals;

    })();
    return angular.module('admin.factory', []).factory('Modals', function() {
      return new Modals();
    });
  });

}).call(this);
